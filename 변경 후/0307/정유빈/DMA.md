<h1> DMA(Direct Memory Access) </h1>

<b> 배경 </b>
- 원칙적으로 메모리는 CPU에 의해서만 접근이 가능하다.
- 따라서, 주변 장치들이 메모리에 접근하기 위해서는 CPU에게 인터럽트를 발생시켜 CPU가 일을 대행하는 식으로만 가능하다.
- 하지만, 모든 메모리 접근 연산이 CPU에 의해서만 이루어질 경우 주변 장치가 메모리 접근을 원할 때마다 인터럽트를 통해 CPU의 업무를 방해받게 되어 CPU 사용의 효율성이 떨어지는 문제가 발생한다.

<b> 기능 및 정의 </b>

- 이러한 비효율성을 극복하기 위해 CPU 이외의 메모리 접근이 가능한 장치를 두는 이 장치가 바로 <b> DMA(Direct Memory Acces) </b> 이다.
- DMA는 일종의 컨트롤러로서, CPU가 주변 장치들의 메모리 접근 요청에 의해 자주 인터럽트 당하는 것을 막아준다.

![image](https://user-images.githubusercontent.com/62228401/223291469-757af57a-2ffe-4911-8b30-258309157254.png)
- DMA를 사용하게 되면 로컬 버퍼에서 메모리로 읽어오는 작업을 CPU가 담당하는 것이 아니라, DMA가 대행함으로써 CPU는 원래 하던 작업을 멈추고 인터럽트를 처리할 필요가 없어진다.
- DMA는 byte 단위가 아닌 block이라는 큰 단위로 정보를 메모리로 읽어온 후에 CPU에게 인터럽트를 발생시켜 해당 작업의 완료를 알립니다.
- 큰 단위로 정보를 분할하기 때문에 인터럽트의 빈도를 줄여 CPU를 더 유용하게 사용하고 입출력 연산을 더욱 빠르게 수행할 수 있게 된다.

- DMA는 CPU를 대신하여 I/O장치와 Memory 사이의 데이터 전송을 담당하는 장치이다.
- DMA에 의한 입출력 방식은 CPU의 개입없이 직접 주기억 장치와 DMA 사이에서 일련의 입출력 동작이 이루어지는 방식이다.

<h3> 왜 DMA가 나왔을까? </h3>

- DMA가 나온 경우는 인터럽트 때문이다.
- 인터럽트는 CPU가 하던 일을 멈추고 다른 일을 하도록 하는데, 이 과정은 CPU가 해야할 일들을 비효율적으로 하게 된다.
- 그리고, I/O 장치 중에서도 고속장치가 있는데 너무 빠르면 인터럽트를 거는 주기 또한 빨라지게 되어 더욱 비효율적으로 된다.

<h3> 메모리에 접근할 수 있는 장치는? </h3>

- 메모리에 접근할 수 있는 장치는 CPU밖에 없다.
- 예를 들면, 디스크 컨트롤러가 파일에 읽는 내용을 메모리에 옮겨 놓을 수 없다.
- 따라서, I/O 장치들은 로컬 버퍼를 가지고 있고 이를 통해 CPU에게 알려주면 CPU가 직접 버퍼에 있는 내용을 자신의 메모리로 카피해서 가져간다.

![image](https://user-images.githubusercontent.com/62228401/223292328-3714a89c-60fc-4ae7-968d-071a059afa34.png)

- DMA는 인터럽트가 너무 자주 걸리는 걸 막기 위해서, 아주 작은 크기의 I/O 로컬 버퍼가 들어가 있다면 특정 블록 단위까지 찾을 때까지 기다렸다가 DMA가 직접 메모리에 카피해주는 작업까지 해주고 그것이 끝났을 때 CPU한테 인터럽트를 거는 방식으로 작동하고, 결과적으로 인터럽트 횟수를 낮출 수 있다.


<h3> DMA 특징 </h3>

- CPU를 경우하지 않고, 직접 기억 장치와 입출력 장치 사이에서 전송이 이루어진다.
- 하나의 입출력 명령어에 의해 하나의 블록 전체가 전송된다.
- 사이클 스틸에 의해 전송이 이루어진다.
- 전송이 끝나면 인터럽트를 발생시켜 CPU에게 알린다.
- 데이터 전송 절차 : 버스 사용 요구 -> 버스 사용 허가 -> 데이터 전송 -> 인터럽트

<h3> DMA 필요성 </h3>

- 고속의 I/O 장치의 경우 CPU의 실제 프로세스 작업 시간 감소
- 디스크와 같은 많은 데이터를 입/출력 하는 장치를 위해 CPU가 매번 전송을 제어하는 방법의 비효율성
- 인터럽트 방식이 프로그램에 의한 입출력 방식보다 효율적이지만 입출력을 위한 상태, 제어 정보, 데이터 전송을 위해서 능동적인 CPU 개입이 필요 -> 오버헤드 발생

<h3> DAM I/O와 Direct I/O 환경 비교 </h3>

![image](https://user-images.githubusercontent.com/62228401/223290719-ba51d713-28e2-4ef6-8309-d235266bedc2.png)

- DAM I/O -> DMA 기반 Data 처리 중 CPU는 다른 프로세스를 처리한다.

![image](https://user-images.githubusercontent.com/62228401/223290800-26b82eac-7f5a-4881-a84f-459316bcfced.png)

- Direct I/O(DMA 미사용) - Data I/O 처리 시 완료까지 작업 중지, CPU 대기 필요
