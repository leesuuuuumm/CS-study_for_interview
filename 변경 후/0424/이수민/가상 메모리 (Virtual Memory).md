# 가상 메모리 (Virtual Memory)

## 등장 배경
- 오버레이 기법을 사용해 메모리 부족 문제를 해결하고자 했었는데, 애초부터 시스템이 프로그램을 위한 충분한 메모리를 갖추고 있찌 않은 경우에는 똑같은 메모리 부족 오류가 발생했다.
- 오버레이 기법: 프로그래머가 애플리케이션의 일부분만 기억장치에 올려 실행하도록 지정할 수 있게 하는 기법

- 더 발전한것이 가상 메모리 기법이다.
- 애플리케이션을 실행하는 데 얼마나 많은 메모리가 필요한지에 집중하지 않고, 애플리케이션을 실행하는 데 최소한 얼마만큼의 메모리가 필요한가에 집중하여 문제를 해결하고자 함.

</br>

이렇게 접근하는 방식이 가능한 이유는, 메모리 접근은 순차적이고 지역화되어 있기 때문임. </br>
그렇다면 이렇게 애플리케이션의 일부분만 메모리(기억장치)에 올려진다면, 메모리에 올라가지 않는 나머지는 어디에 위치해야 할까? ⇒ 정답은 보조 기억장치, 즉 디스크 </br>
가상 메모리의 핵심은 보조 기억장치다. </br>

</br>

## 가상 메모리란?
- 메모리가 실제 메모리보다 많아 보이게 하는 기술로 어떤 프로세스가 실행될 때 메모리에 해당 프로세스 전체가 올라가지 않더라도 실행기 가능하다. 
- 실행이 필요한 일부분만 메모리에 올라가며 애플리케이션의 나머지는 디스크에 남게 된다. 즉, 디스크가 RAM의 보조기억장치처럼 작동하는 것이다. </br>
- 결국 빠르고 작은 기억장치인 RAM을 크고 느린 기억장치 디스크와 병합하여, 하나의 크고 빠른 기억장치인 가상 메모리 처럼 동작하게 하는 것이다. 

- 가상 메모리를 구현하기 위해서는 MMU같은 특수 메모리 관리 하드웨어를 갖추고 있어야한다.

### MMU
- 가상 주소를 물리주소로 변환, 메모리르 보호하는 기능 수행한다.
- CPU가 각 메모리에 접근하기 이전에 메모리 주소 번역 작업이 수행된다.
- 메모리를 일일이 가상 주소에서 물리적 주소로 번역하게 되면 작업 부하가 너무 높아지므로, MMU는 RAM을 여러 부분(페이지)로 나눠 각 페이지를 하나의 독립된 항목으로 처리한다. 
- 페이지 및 주소 번역 정보를 기억하는 작업이 가상 메모리를 구현하는 데 있어 결정적인 절차이다.

</br>

## 요구 페이징?
-  CPU가 요청할 때 프로세스의 데이터를 메모리에 올리는 것을 의미함
-  처음부터 모든 데이터를 메모리로 적재하지 않음

## 페이지 폴트?
- 어떤 프로그램이 자신의 주소 공간(가상 메모리 공간)에는 존재하지만, 시스템의 RAM에는 존재하지 않는 데이터, 코드에 접근을 시도할 경우 발생하는 현상을 의미한다. 
- 페이지 폴트가 발생하면 OS는 그 데이터를 메모리로 가져와, 페이지 폴트가 전혀 발생하지 않은 것처럼 프로그램이 계속적으로 작동하게 해준다. 
- 페이지 폴트가 자주 일어날수록 OS의 성능이 많이 저하되기 때문에 페이지 폴트를 최소하 하기 위한 방법으로 페이지 교체 알고리즘을 사용한다. 


##  TLB(페이지 정보 캐쉬)?
- 가상메모리를 물리적 주소로 변환하는 속도를 높이기 위해 사용되는 캐시로, 가장 최근에 일어난 가상 메모리와 물리 주소의 변환 테이블을 저장해둔다.
- TLB는 MMU에 포함되어 있는 작은 캐시로, 일종의 주소 변환 캐시라고 할 수 있다.

### 캐시 메모리?
- 속도가 빠른 장치와 느린 장치 사이에서 속도 차에 따른 병목 현상을 줄이기 위한 범용 메모리를 의미한다.

</br>
(예) </br>
- CPU에서의 캐시 메모리는 CPU 코어(속도)와 메모리(CPU에 비해 저속) 사이에서 속도 차에 따른 병목 현상을 완화하는 역할을 한다.
- 레지스터와 주기억 장치의 속도차 개선
- CPU가 주기억장치에서 저장된 데이터를 읽어올 때, 자주 사용하는 데이터를 캐시 메모리에 저장한 뒤, 다음에 이용할 때 주기억장치가 아닌 캐시 메모리에서 먼저 가져오면서 속도를 향상시킨다.



- 웹 브라우저에서 캐시 파일 개념은 웹 페이지 상의 이미지등을 하드디스크에 미리 정리해두고, 다음 번에도 해당 웹 페이지에 접근할 때 해당 웹 사이트에 이미지를 다시 요청하는 게 아니라 하드디스크에서 이미지를 불러들어 로딩 속도를 높이는 역할을 한다.
- 즉, 캐시 파일은 비교적 속도가 빠른 하드디스크와 상대적으로 느린 웹 페이지 가운데에서의 병목을 줄이는 역할을 한다.

</br>

### TLB 장점
- 물리주소를 갖고 있으면 메모리(RAM)에 두 번 들릴 필요없이, 바로 해당 물리주소로 찾아 갈 수 있다.
